{% extends 'layout.html' %} {% block title %} Todo List {% endblock %}
{% block top_actions %}
<a class="btn" href="/action_plan/{{ action_plan_id }}">Back to Template</a>
{% if not is_completed and not is_action_plan_deleted %}
<a class="btn" href="/action_plan/{{ action_plan_id }}/edit?execution_id={{ id }}">Edit Plan</a>
{% endif %}
{% endblock %}
{% block content %}
<div class="details-card">
    <div class="plan-name">{{ action_plan_name }}</div>
    <p class="muted">Execution ID: {{ id }}</p>
    <p class="muted">Started: {{ started_display }}</p>
    <p class="muted">Completed: {% if finished_display %}{{ finished_display }}{% else %}-{% endif %}</p>
    <table class="items-table">
        <thead>
            <tr><th>Task</th><th class="done-col">Done</th></tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td>
                    <div>{{ item.name }}</div>
                    <div class="muted finished-at">
                        {% if item.finished_display %}
                        Finished: {{ item.finished_display }}
                        {% endif %}
                    </div>
                </td>
                <td class="done-col">
                    <input
                        type="checkbox"
                        class="execution-item-toggle"
                        data-url="/execution-items/{{ item.id }}/finished"
                        {% if item.is_finished %}checked{% endif %}
                        {% if is_completed %}disabled{% endif %}
                    />
                </td>
            </tr>
            {% else %}
            <tr><td colspan="2" class="muted">No items in this todo list.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
{% block bottom_actions %}
{% if not is_completed %}
<a
    class="btn btn-primary execution-complete-link {% if not can_complete %}is-disabled{% endif %}"
    href="/executions/{{ id }}/complete"
    aria-disabled="{% if can_complete %}false{% else %}true{% endif %}"
>
    Complete Execution
</a>
<a class="btn btn-danger" href="/executions/{{ id }}/delete">Delete Execution</a>
{% elif can_reopen %}
<a class="btn" href="/executions/{{ id }}/reopen">Reopen Execution</a>
{% endif %}
{% endblock %}
