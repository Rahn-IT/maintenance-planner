{% extends 'layout.html' %} {% block title %} Action Plan {% endblock %}
{% block top_actions %}
{% if is_deleted %}
<form method="post" action="/action_plan/{{id}}/undelete">
    <button class="btn btn-primary" type="submit">Undelete</button>
</form>
{% else %}
<a class="btn" href="/action_plan/{{id}}/edit">Edit</a>
<form method="post" action="/action_plan/{{id}}/delete">
    <button class="btn btn-danger" type="submit">Delete</button>
</form>
{% if active_execution_link %}
<a class="btn btn-primary" href="/executions/{{ active_execution_link }}">Continue Active Execution</a>
{% else %}
<form method="post" action="/action_plan/{{id}}/execute">
    <button class="btn btn-primary" type="submit">Start Execution</button>
</form>
{% endif %}
{% endif %}
{% endblock %}
{% block content %}
<div class="details-card">
    <div class="plan-name">{{ name }}</div>
    {% if is_deleted %}
    <p class="muted">Deleted: {{ deleted_at_display }}</p>
    {% endif %}
    <table class="items-table">
        <thead>
            <tr><th>Task</th></tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr><td>{{ item.name }}</td></tr>
            {% else %}
            <tr><td class="muted">No items in this plan yet.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<h2>Active Executions</h2>
<div class="plan-list">
    {% for execution in active_executions %}
    <a class="plan-card" href="/executions/{{ execution.id }}">
        <h2>Execution {{ execution.id }}</h2>
        <p class="muted">Started: {{ execution.started_display }}</p>
    </a>
    {% else %}
    <p class="muted">No active executions.</p>
    {% endfor %}
</div>

<h2>Finished Executions</h2>
<div class="plan-list">
    {% for execution in finished_executions %}
    <a class="plan-card" href="/executions/{{ execution.id }}">
        <h2>Execution {{ execution.id }}</h2>
        <p class="muted">Started: {{ execution.started_display }}</p>
        <p class="muted">Finished: {{ execution.finished_display }}</p>
    </a>
    {% else %}
    <p class="muted">No finished executions yet.</p>
    {% endfor %}
</div>
{% endblock %}
